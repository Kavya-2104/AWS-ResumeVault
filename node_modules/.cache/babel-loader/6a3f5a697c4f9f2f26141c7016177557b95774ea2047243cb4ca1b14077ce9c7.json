{"ast":null,"code":"import { Amplify, fetchAuthSession } from '@aws-amplify/core';\nimport { assertTokenProviderConfig, AuthAction } from '@aws-amplify/core/internals/utils';\nimport { updateUserAttributes as updateUserAttributes$1 } from '../utils/clients/CognitoIdentityProvider/index.mjs';\nimport { assertAuthTokens } from '../utils/types.mjs';\nimport { getRegion } from '../utils/clients/CognitoIdentityProvider/utils.mjs';\nimport { toAttributeType } from '../utils/apiHelpers.mjs';\nimport { getAuthUserAgentValue } from '../../../utils/getAuthUserAgentValue.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Updates user's attributes while authenticated.\n *\n * @param input - The UpdateUserAttributesInput object\n * @returns UpdateUserAttributesOutput\n * @throws - {@link UpdateUserAttributesException}\n * @throws AuthTokenConfigException - Thrown when the token provider config is invalid.\n */\nconst updateUserAttributes = async input => {\n  const {\n    userAttributes,\n    options\n  } = input;\n  const authConfig = Amplify.getConfig().Auth?.Cognito;\n  const clientMetadata = options?.clientMetadata;\n  assertTokenProviderConfig(authConfig);\n  const {\n    tokens\n  } = await fetchAuthSession({\n    forceRefresh: false\n  });\n  assertAuthTokens(tokens);\n  const {\n    CodeDeliveryDetailsList\n  } = await updateUserAttributes$1({\n    region: getRegion(authConfig.userPoolId),\n    userAgentValue: getAuthUserAgentValue(AuthAction.UpdateUserAttributes)\n  }, {\n    AccessToken: tokens.accessToken.toString(),\n    ClientMetadata: clientMetadata,\n    UserAttributes: toAttributeType(userAttributes)\n  });\n  return {\n    ...getConfirmedAttributes(userAttributes),\n    ...getUnConfirmedAttributes(CodeDeliveryDetailsList)\n  };\n};\nfunction getConfirmedAttributes(attributes) {\n  const confirmedAttributes = {};\n  Object.keys(attributes)?.forEach(key => {\n    confirmedAttributes[key] = {\n      isUpdated: true,\n      nextStep: {\n        updateAttributeStep: 'DONE'\n      }\n    };\n  });\n  return confirmedAttributes;\n}\nfunction getUnConfirmedAttributes(codeDeliveryDetailsList) {\n  const unConfirmedAttributes = {};\n  codeDeliveryDetailsList?.forEach(codeDeliveryDetails => {\n    const {\n      AttributeName,\n      DeliveryMedium,\n      Destination\n    } = codeDeliveryDetails;\n    if (AttributeName) unConfirmedAttributes[AttributeName] = {\n      isUpdated: false,\n      nextStep: {\n        updateAttributeStep: 'CONFIRM_ATTRIBUTE_WITH_CODE',\n        codeDeliveryDetails: {\n          attributeName: AttributeName,\n          deliveryMedium: DeliveryMedium,\n          destination: Destination\n        }\n      }\n    };\n  });\n  return unConfirmedAttributes;\n}\nexport { updateUserAttributes };","map":{"version":3,"names":["updateUserAttributes","input","userAttributes","options","authConfig","Amplify","getConfig","Auth","Cognito","clientMetadata","assertTokenProviderConfig","tokens","fetchAuthSession","forceRefresh","assertAuthTokens","CodeDeliveryDetailsList","updateUserAttributes$1","region","getRegion","userPoolId","userAgentValue","getAuthUserAgentValue","AuthAction","UpdateUserAttributes","AccessToken","accessToken","toString","ClientMetadata","UserAttributes","toAttributeType","getConfirmedAttributes","getUnConfirmedAttributes","attributes","confirmedAttributes","Object","keys","forEach","key","isUpdated","nextStep","updateAttributeStep","codeDeliveryDetailsList","unConfirmedAttributes","codeDeliveryDetails","AttributeName","DeliveryMedium","Destination","attributeName","deliveryMedium","destination"],"sources":["E:\\CSC-PROJECT\\amplify-react-app\\node_modules\\@aws-amplify\\auth\\src\\providers\\cognito\\apis\\updateUserAttributes.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { Amplify, fetchAuthSession } from '@aws-amplify/core';\nimport { AuthAction, assertTokenProviderConfig, } from '@aws-amplify/core/internals/utils';\nimport { updateUserAttributes as updateUserAttributesClient } from '../utils/clients/CognitoIdentityProvider';\nimport { assertAuthTokens } from '../utils/types';\nimport { getRegion } from '../utils/clients/CognitoIdentityProvider/utils';\nimport { toAttributeType } from '../utils/apiHelpers';\nimport { getAuthUserAgentValue } from '../../../utils';\n/**\n * Updates user's attributes while authenticated.\n *\n * @param input - The UpdateUserAttributesInput object\n * @returns UpdateUserAttributesOutput\n * @throws - {@link UpdateUserAttributesException}\n * @throws AuthTokenConfigException - Thrown when the token provider config is invalid.\n */\nexport const updateUserAttributes = async (input) => {\n    const { userAttributes, options } = input;\n    const authConfig = Amplify.getConfig().Auth?.Cognito;\n    const clientMetadata = options?.clientMetadata;\n    assertTokenProviderConfig(authConfig);\n    const { tokens } = await fetchAuthSession({ forceRefresh: false });\n    assertAuthTokens(tokens);\n    const { CodeDeliveryDetailsList } = await updateUserAttributesClient({\n        region: getRegion(authConfig.userPoolId),\n        userAgentValue: getAuthUserAgentValue(AuthAction.UpdateUserAttributes),\n    }, {\n        AccessToken: tokens.accessToken.toString(),\n        ClientMetadata: clientMetadata,\n        UserAttributes: toAttributeType(userAttributes),\n    });\n    return {\n        ...getConfirmedAttributes(userAttributes),\n        ...getUnConfirmedAttributes(CodeDeliveryDetailsList),\n    };\n};\nfunction getConfirmedAttributes(attributes) {\n    const confirmedAttributes = {};\n    Object.keys(attributes)?.forEach(key => {\n        confirmedAttributes[key] = {\n            isUpdated: true,\n            nextStep: {\n                updateAttributeStep: 'DONE',\n            },\n        };\n    });\n    return confirmedAttributes;\n}\nfunction getUnConfirmedAttributes(codeDeliveryDetailsList) {\n    const unConfirmedAttributes = {};\n    codeDeliveryDetailsList?.forEach(codeDeliveryDetails => {\n        const { AttributeName, DeliveryMedium, Destination } = codeDeliveryDetails;\n        if (AttributeName)\n            unConfirmedAttributes[AttributeName] = {\n                isUpdated: false,\n                nextStep: {\n                    updateAttributeStep: 'CONFIRM_ATTRIBUTE_WITH_CODE',\n                    codeDeliveryDetails: {\n                        attributeName: AttributeName,\n                        deliveryMedium: DeliveryMedium,\n                        destination: Destination,\n                    },\n                },\n            };\n    });\n    return unConfirmedAttributes;\n}\n"],"mappings":";;;;;;;;AAAA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACA,oBAAoB,GAAG,MAAOC,KAAK,IAAK;EACjD,MAAM;IAAEC,cAAc;IAAEC;EAAO,CAAE,GAAGF,KAAK;EACzC,MAAMG,UAAU,GAAGC,OAAO,CAACC,SAAS,EAAE,CAACC,IAAI,EAAEC,OAAO;EACpD,MAAMC,cAAc,GAAGN,OAAO,EAAEM,cAAc;EAC9CC,yBAAyB,CAACN,UAAU,CAAC;EACrC,MAAM;IAAEO;EAAM,CAAE,GAAG,MAAMC,gBAAgB,CAAC;IAAEC,YAAY,EAAE;EAAK,CAAE,CAAC;EAClEC,gBAAgB,CAACH,MAAM,CAAC;EACxB,MAAM;IAAEI;EAAuB,CAAE,GAAG,MAAMC,sBAA0B,CAAC;IACjEC,MAAM,EAAEC,SAAS,CAACd,UAAU,CAACe,UAAU,CAAC;IACxCC,cAAc,EAAEC,qBAAqB,CAACC,UAAU,CAACC,oBAAoB;EAC7E,CAAK,EAAE;IACCC,WAAW,EAAEb,MAAM,CAACc,WAAW,CAACC,QAAQ,EAAE;IAC1CC,cAAc,EAAElB,cAAc;IAC9BmB,cAAc,EAAEC,eAAe,CAAC3B,cAAc;EACtD,CAAK,CAAC;EACF,OAAO;IACH,GAAG4B,sBAAsB,CAAC5B,cAAc,CAAC;IACzC,GAAG6B,wBAAwB,CAAChB,uBAAuB;EAC3D,CAAK;AACL;AACA,SAASe,sBAAsBA,CAACE,UAAU,EAAE;EACxC,MAAMC,mBAAmB,GAAG,EAAE;EAC9BC,MAAM,CAACC,IAAI,CAACH,UAAU,CAAC,EAAEI,OAAO,CAACC,GAAG,IAAI;IACpCJ,mBAAmB,CAACI,GAAG,CAAC,GAAG;MACvBC,SAAS,EAAE,IAAI;MACfC,QAAQ,EAAE;QACNC,mBAAmB,EAAE;MACrC;IACA,CAAS;EACT,CAAK,CAAC;EACF,OAAOP,mBAAmB;AAC9B;AACA,SAASF,wBAAwBA,CAACU,uBAAuB,EAAE;EACvD,MAAMC,qBAAqB,GAAG,EAAE;EAChCD,uBAAuB,EAAEL,OAAO,CAACO,mBAAmB,IAAI;IACpD,MAAM;MAAEC,aAAa;MAAEC,cAAc;MAAEC;IAAW,CAAE,GAAGH,mBAAmB;IAC1E,IAAIC,aAAa,EACbF,qBAAqB,CAACE,aAAa,CAAC,GAAG;MACnCN,SAAS,EAAE,KAAK;MAChBC,QAAQ,EAAE;QACNC,mBAAmB,EAAE,6BAA6B;QAClDG,mBAAmB,EAAE;UACjBI,aAAa,EAAEH,aAAa;UAC5BI,cAAc,EAAEH,cAAc;UAC9BI,WAAW,EAAEH;QACrC;MACA;IACA,CAAa;EACb,CAAK,CAAC;EACF,OAAOJ,qBAAqB;AAChC"},"metadata":{},"sourceType":"module","externalDependencies":[]}