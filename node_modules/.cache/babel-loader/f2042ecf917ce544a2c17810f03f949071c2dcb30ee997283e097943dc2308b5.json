{"ast":null,"code":"import { ConsoleLogger } from '../Logger/ConsoleLogger.mjs';\nimport { NO_HUBCALLBACK_PROVIDED_EXCEPTION } from '../constants.mjs';\nimport { AmplifyError } from '../errors/AmplifyError.mjs';\nimport '../types/errors.mjs';\nimport '../errors/errorHelpers.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst AMPLIFY_SYMBOL = typeof Symbol !== 'undefined' ? Symbol('amplify_default') : '@@amplify_default';\nconst logger = new ConsoleLogger('Hub');\nclass HubClass {\n  constructor(name) {\n    this.listeners = new Map();\n    this.protectedChannels = ['core', 'auth', 'api', 'analytics', 'interactions', 'pubsub', 'storage', 'ui', 'xr'];\n    this.name = name;\n  }\n  /**\n   * Used internally to remove a Hub listener.\n   *\n   * @remarks\n   * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n   */\n  _remove(channel, listener) {\n    const holder = this.listeners.get(channel);\n    if (!holder) {\n      logger.warn(`No listeners for ${channel}`);\n      return;\n    }\n    this.listeners.set(channel, [...holder.filter(({\n      callback\n    }) => callback !== listener)]);\n  }\n  dispatch(channel, payload, source, ampSymbol) {\n    if (typeof channel === 'string' && this.protectedChannels.indexOf(channel) > -1) {\n      const hasAccess = ampSymbol === AMPLIFY_SYMBOL;\n      if (!hasAccess) {\n        logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n      }\n    }\n    const capsule = {\n      channel,\n      payload: {\n        ...payload\n      },\n      source,\n      patternInfo: []\n    };\n    try {\n      this._toListeners(capsule);\n    } catch (e) {\n      logger.error(e);\n    }\n  }\n  listen(channel, callback, listenerName = 'noname') {\n    let cb;\n    if (typeof callback !== 'function') {\n      throw new AmplifyError({\n        name: NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n        message: 'No callback supplied to Hub'\n      });\n    } else {\n      // Needs to be casted as a more generic type\n      cb = callback;\n    }\n    let holder = this.listeners.get(channel);\n    if (!holder) {\n      holder = [];\n      this.listeners.set(channel, holder);\n    }\n    holder.push({\n      name: listenerName,\n      callback: cb\n    });\n    return () => {\n      this._remove(channel, cb);\n    };\n  }\n  _toListeners(capsule) {\n    const {\n      channel,\n      payload\n    } = capsule;\n    const holder = this.listeners.get(channel);\n    if (holder) {\n      holder.forEach(listener => {\n        logger.debug(`Dispatching to ${channel} with `, payload);\n        try {\n          listener.callback(capsule);\n        } catch (e) {\n          logger.error(e);\n        }\n      });\n    }\n  }\n}\n/*We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events.*/\nconst Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nconst HubInternal = new HubClass('internal-hub');\nexport { AMPLIFY_SYMBOL, Hub, HubClass, HubInternal };","map":{"version":3,"names":["AMPLIFY_SYMBOL","Symbol","logger","ConsoleLogger","HubClass","constructor","name","listeners","Map","protectedChannels","_remove","channel","listener","holder","get","warn","set","filter","callback","dispatch","payload","source","ampSymbol","indexOf","hasAccess","capsule","patternInfo","_toListeners","e","error","listen","listenerName","cb","AmplifyError","NO_HUBCALLBACK_PROVIDED_EXCEPTION","message","push","forEach","debug","Hub","HubInternal"],"sources":["E:\\CSC-PROJECT\\amplify-react-app\\node_modules\\@aws-amplify\\core\\src\\Hub\\index.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { ConsoleLogger } from '../Logger';\nimport { NO_HUBCALLBACK_PROVIDED_EXCEPTION } from '../constants';\nimport { AmplifyError } from '../errors';\nexport const AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined'\n    ? Symbol('amplify_default')\n    : '@@amplify_default');\nconst logger = new ConsoleLogger('Hub');\nexport class HubClass {\n    constructor(name) {\n        this.listeners = new Map();\n        this.protectedChannels = [\n            'core',\n            'auth',\n            'api',\n            'analytics',\n            'interactions',\n            'pubsub',\n            'storage',\n            'ui',\n            'xr',\n        ];\n        this.name = name;\n    }\n    /**\n     * Used internally to remove a Hub listener.\n     *\n     * @remarks\n     * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n     */\n    _remove(channel, listener) {\n        const holder = this.listeners.get(channel);\n        if (!holder) {\n            logger.warn(`No listeners for ${channel}`);\n            return;\n        }\n        this.listeners.set(channel, [\n            ...holder.filter(({ callback }) => callback !== listener),\n        ]);\n    }\n    dispatch(channel, payload, source, ampSymbol) {\n        if (typeof channel === 'string' &&\n            this.protectedChannels.indexOf(channel) > -1) {\n            const hasAccess = ampSymbol === AMPLIFY_SYMBOL;\n            if (!hasAccess) {\n                logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n            }\n        }\n        const capsule = {\n            channel,\n            payload: { ...payload },\n            source,\n            patternInfo: [],\n        };\n        try {\n            this._toListeners(capsule);\n        }\n        catch (e) {\n            logger.error(e);\n        }\n    }\n    listen(channel, callback, listenerName = 'noname') {\n        let cb;\n        if (typeof callback !== 'function') {\n            throw new AmplifyError({\n                name: NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n                message: 'No callback supplied to Hub',\n            });\n        }\n        else {\n            // Needs to be casted as a more generic type\n            cb = callback;\n        }\n        let holder = this.listeners.get(channel);\n        if (!holder) {\n            holder = [];\n            this.listeners.set(channel, holder);\n        }\n        holder.push({\n            name: listenerName,\n            callback: cb,\n        });\n        return () => {\n            this._remove(channel, cb);\n        };\n    }\n    _toListeners(capsule) {\n        const { channel, payload } = capsule;\n        const holder = this.listeners.get(channel);\n        if (holder) {\n            holder.forEach(listener => {\n                logger.debug(`Dispatching to ${channel} with `, payload);\n                try {\n                    listener.callback(capsule);\n                }\n                catch (e) {\n                    logger.error(e);\n                }\n            });\n        }\n    }\n}\n/*We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events.*/\nexport const Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nexport const HubInternal = new HubClass('internal-hub');\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}