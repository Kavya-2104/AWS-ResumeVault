{"ast":null,"code":"import { Amplify } from '@aws-amplify/core';\nimport { assertTokenProviderConfig, AuthAction, HubInternal } from '@aws-amplify/core/internals/utils';\nimport { assertValidationError } from '../../../errors/utils/assertValidationError.mjs';\nimport { AuthValidationErrorCode } from '../../../errors/types/validation.mjs';\nimport { confirmSignUp as confirmSignUp$1 } from '../utils/clients/CognitoIdentityProvider/index.mjs';\nimport { getRegion } from '../utils/clients/CognitoIdentityProvider/utils.mjs';\nimport { isAutoSignInStarted, isAutoSignInUserUsingConfirmSignUp, setAutoSignInStarted } from '../utils/signUpHelpers.mjs';\nimport { getAuthUserAgentValue } from '../../../utils/getAuthUserAgentValue.mjs';\nimport { getUserContextData } from '../utils/userContextData.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Confirms a new user account.\n *\n * @param input -  The ConfirmSignUpInput object.\n * @returns ConfirmSignUpOutput\n * @throws -{@link ConfirmSignUpException }\n * Thrown due to an invalid confirmation code.\n * @throws -{@link AuthValidationErrorCode }\n * Thrown due to an empty confirmation code\n * @throws AuthTokenConfigException - Thrown when the token provider config is invalid.\n */\nasync function confirmSignUp(input) {\n  const {\n    username,\n    confirmationCode,\n    options\n  } = input;\n  const authConfig = Amplify.getConfig().Auth?.Cognito;\n  assertTokenProviderConfig(authConfig);\n  const {\n    userPoolId,\n    userPoolClientId\n  } = authConfig;\n  const clientMetadata = options?.clientMetadata;\n  assertValidationError(!!username, AuthValidationErrorCode.EmptyConfirmSignUpUsername);\n  assertValidationError(!!confirmationCode, AuthValidationErrorCode.EmptyConfirmSignUpCode);\n  const UserContextData = getUserContextData({\n    username,\n    userPoolId,\n    userPoolClientId\n  });\n  await confirmSignUp$1({\n    region: getRegion(authConfig.userPoolId),\n    userAgentValue: getAuthUserAgentValue(AuthAction.ConfirmSignUp)\n  }, {\n    Username: username,\n    ConfirmationCode: confirmationCode,\n    ClientMetadata: clientMetadata,\n    ForceAliasCreation: options?.forceAliasCreation,\n    ClientId: authConfig.userPoolClientId,\n    UserContextData\n  });\n  return new Promise((resolve, reject) => {\n    try {\n      const signUpOut = {\n        isSignUpComplete: true,\n        nextStep: {\n          signUpStep: 'DONE'\n        }\n      };\n      if (!isAutoSignInStarted() || !isAutoSignInUserUsingConfirmSignUp(username)) {\n        return resolve(signUpOut);\n      }\n      const stopListener = HubInternal.listen('auth-internal', ({\n        payload\n      }) => {\n        switch (payload.event) {\n          case 'autoSignIn':\n            resolve({\n              isSignUpComplete: true,\n              nextStep: {\n                signUpStep: 'COMPLETE_AUTO_SIGN_IN'\n              }\n            });\n            setAutoSignInStarted(false);\n            stopListener();\n        }\n      });\n      HubInternal.dispatch('auth-internal', {\n        event: 'confirmSignUp',\n        data: signUpOut\n      });\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\nexport { confirmSignUp };","map":{"version":3,"names":["confirmSignUp","input","username","confirmationCode","options","authConfig","Amplify","getConfig","Auth","Cognito","assertTokenProviderConfig","userPoolId","userPoolClientId","clientMetadata","assertValidationError","AuthValidationErrorCode","EmptyConfirmSignUpUsername","EmptyConfirmSignUpCode","UserContextData","getUserContextData","confirmSignUp$1","region","getRegion","userAgentValue","getAuthUserAgentValue","AuthAction","ConfirmSignUp","Username","ConfirmationCode","ClientMetadata","ForceAliasCreation","forceAliasCreation","ClientId","Promise","resolve","reject","signUpOut","isSignUpComplete","nextStep","signUpStep","isAutoSignInStarted","isAutoSignInUserUsingConfirmSignUp","stopListener","HubInternal","listen","payload","event","setAutoSignInStarted","dispatch","data","error"],"sources":["E:\\CSC-PROJECT\\amplify-react-app\\node_modules\\@aws-amplify\\auth\\src\\providers\\cognito\\apis\\confirmSignUp.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { Amplify } from '@aws-amplify/core';\nimport { assertTokenProviderConfig, AuthAction, HubInternal, } from '@aws-amplify/core/internals/utils';\nimport { assertValidationError } from '../../../errors/utils/assertValidationError';\nimport { AuthValidationErrorCode } from '../../../errors/types/validation';\nimport { confirmSignUp as confirmSignUpClient } from '../utils/clients/CognitoIdentityProvider';\nimport { getRegion } from '../utils/clients/CognitoIdentityProvider/utils';\nimport { isAutoSignInStarted, isAutoSignInUserUsingConfirmSignUp, setAutoSignInStarted, } from '../utils/signUpHelpers';\nimport { getAuthUserAgentValue } from '../../../utils';\nimport { getUserContextData } from '../utils/userContextData';\n/**\n * Confirms a new user account.\n *\n * @param input -  The ConfirmSignUpInput object.\n * @returns ConfirmSignUpOutput\n * @throws -{@link ConfirmSignUpException }\n * Thrown due to an invalid confirmation code.\n * @throws -{@link AuthValidationErrorCode }\n * Thrown due to an empty confirmation code\n * @throws AuthTokenConfigException - Thrown when the token provider config is invalid.\n */\nexport async function confirmSignUp(input) {\n    const { username, confirmationCode, options } = input;\n    const authConfig = Amplify.getConfig().Auth?.Cognito;\n    assertTokenProviderConfig(authConfig);\n    const { userPoolId, userPoolClientId } = authConfig;\n    const clientMetadata = options?.clientMetadata;\n    assertValidationError(!!username, AuthValidationErrorCode.EmptyConfirmSignUpUsername);\n    assertValidationError(!!confirmationCode, AuthValidationErrorCode.EmptyConfirmSignUpCode);\n    const UserContextData = getUserContextData({\n        username,\n        userPoolId,\n        userPoolClientId,\n    });\n    await confirmSignUpClient({\n        region: getRegion(authConfig.userPoolId),\n        userAgentValue: getAuthUserAgentValue(AuthAction.ConfirmSignUp),\n    }, {\n        Username: username,\n        ConfirmationCode: confirmationCode,\n        ClientMetadata: clientMetadata,\n        ForceAliasCreation: options?.forceAliasCreation,\n        ClientId: authConfig.userPoolClientId,\n        UserContextData,\n    });\n    return new Promise((resolve, reject) => {\n        try {\n            const signUpOut = {\n                isSignUpComplete: true,\n                nextStep: {\n                    signUpStep: 'DONE',\n                },\n            };\n            if (!isAutoSignInStarted() ||\n                !isAutoSignInUserUsingConfirmSignUp(username)) {\n                return resolve(signUpOut);\n            }\n            const stopListener = HubInternal.listen('auth-internal', ({ payload }) => {\n                switch (payload.event) {\n                    case 'autoSignIn':\n                        resolve({\n                            isSignUpComplete: true,\n                            nextStep: {\n                                signUpStep: 'COMPLETE_AUTO_SIGN_IN',\n                            },\n                        });\n                        setAutoSignInStarted(false);\n                        stopListener();\n                }\n            });\n            HubInternal.dispatch('auth-internal', {\n                event: 'confirmSignUp',\n                data: signUpOut,\n            });\n        }\n        catch (error) {\n            reject(error);\n        }\n    });\n}\n"],"mappings":";;;;;;;;;;AAAA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,eAAeA,aAAaA,CAACC,KAAK,EAAE;EACvC,MAAM;IAAEC,QAAQ;IAAEC,gBAAgB;IAAEC;EAAO,CAAE,GAAGH,KAAK;EACrD,MAAMI,UAAU,GAAGC,OAAO,CAACC,SAAS,EAAE,CAACC,IAAI,EAAEC,OAAO;EACpDC,yBAAyB,CAACL,UAAU,CAAC;EACrC,MAAM;IAAEM,UAAU;IAAEC;EAAgB,CAAE,GAAGP,UAAU;EACnD,MAAMQ,cAAc,GAAGT,OAAO,EAAES,cAAc;EAC9CC,qBAAqB,CAAC,CAAC,CAACZ,QAAQ,EAAEa,uBAAuB,CAACC,0BAA0B,CAAC;EACrFF,qBAAqB,CAAC,CAAC,CAACX,gBAAgB,EAAEY,uBAAuB,CAACE,sBAAsB,CAAC;EACzF,MAAMC,eAAe,GAAGC,kBAAkB,CAAC;IACvCjB,QAAQ;IACRS,UAAU;IACVC;EACR,CAAK,CAAC;EACF,MAAMQ,eAAmB,CAAC;IACtBC,MAAM,EAAEC,SAAS,CAACjB,UAAU,CAACM,UAAU,CAAC;IACxCY,cAAc,EAAEC,qBAAqB,CAACC,UAAU,CAACC,aAAa;EACtE,CAAK,EAAE;IACCC,QAAQ,EAAEzB,QAAQ;IAClB0B,gBAAgB,EAAEzB,gBAAgB;IAClC0B,cAAc,EAAEhB,cAAc;IAC9BiB,kBAAkB,EAAE1B,OAAO,EAAE2B,kBAAkB;IAC/CC,QAAQ,EAAE3B,UAAU,CAACO,gBAAgB;IACrCM;EACR,CAAK,CAAC;EACF,OAAO,IAAIe,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACpC,IAAI;MACA,MAAMC,SAAS,GAAG;QACdC,gBAAgB,EAAE,IAAI;QACtBC,QAAQ,EAAE;UACNC,UAAU,EAAE;QAChC;MACA,CAAa;MACD,IAAI,CAACC,mBAAmB,EAAE,IACtB,CAACC,kCAAkC,CAACvC,QAAQ,CAAC,EAAE;QAC/C,OAAOgC,OAAO,CAACE,SAAS,CAAC;MACzC;MACY,MAAMM,YAAY,GAAGC,WAAW,CAACC,MAAM,CAAC,eAAe,EAAE,CAAC;QAAEC;MAAO,CAAE,KAAK;QACtE,QAAQA,OAAO,CAACC,KAAK;UACjB,KAAK,YAAY;YACbZ,OAAO,CAAC;cACJG,gBAAgB,EAAE,IAAI;cACtBC,QAAQ,EAAE;gBACNC,UAAU,EAAE;cAC5C;YACA,CAAyB,CAAC;YACFQ,oBAAoB,CAAC,KAAK,CAAC;YAC3BL,YAAY,EAAE;QACtC;MACA,CAAa,CAAC;MACFC,WAAW,CAACK,QAAQ,CAAC,eAAe,EAAE;QAClCF,KAAK,EAAE,eAAe;QACtBG,IAAI,EAAEb;MACtB,CAAa,CAAC;IACd,CAAS,CACD,OAAOc,KAAK,EAAE;MACVf,MAAM,CAACe,KAAK,CAAC;IACzB;EACA,CAAK,CAAC;AACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}